flowchart TD
  subgraph frontend["Frontend"]
    n1["End User"]
    n2["React SPA"]
  end

  subgraph backend["Backend"]
    n3["FastAPI Server"]
    n4["Auth Service"]
  end

  subgraph orchestration["LangGraph Orchestration"]
    n5["Intent Classifier"]
    n6["PII Masking"]
    n7["RAG Retrieval"]
    n8["LLM Generation"]
  end

  subgraph persistence["Persistence & Vector DB"]
    n9[("Qdrant")]
    n10[("MongoDB")]
    n11[("Postgres")]
    n12[("Redis Cache")]
  end

  subgraph observability["Observability"]
    n13["Langfuse Traces"]
    n14["Circuit Breaker"]
  end

  n1 -->|HTTPS| n2
  n2 -->|REST / WebSocket| n3
  n3 --> n4
  n3 --> n5
  n5 --> n6
  n6 --> n7
  n7 --> n8
  n7 -->|Vector Search| n9
  n8 -->|Save Chat| n10
  n3 -->|Read Docs| n11
  n3 -->|Session Cache| n12
  n3 -->|Telemetry| n13
  n3 -->|Latency / Errors| n14
